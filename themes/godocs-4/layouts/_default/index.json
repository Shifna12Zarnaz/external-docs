{{- $len := sub (len (.Pages.GroupBy "Section")) 1 -}}
[{{- range $item, $el := .Pages.GroupBy "Section" -}}
  {{- range $i, $e := .Pages -}}
    {{- if and (not .Params.ignoreSearch) (.Params.visible) (ne $e.Type "json") -}}
      {
        "version": "",
        "url": "{{ $e.Permalink }}",
        "title": "{{ with $e.Params.bannertext }}{{htmlEscape .}}{{else}}{{htmlEscape $e.Title}}{{end}}",
        "description": "{{ htmlEscape .Description}}",
        "searchKeyword": "{{ htmlEscape .Params.searchKeyword}}",
        "content": {{$e.Plain | jsonify}},
        "_293yh2": ""
      },
    {{- end -}}

    {{- if .Section -}}
      {{- $section := (where site.Pages "Section" .Section) | intersect (where site.Pages ".Title" "!=" .Title) -}}
      {{- $sectionLen := len (where site.Pages "Section" .Section) -}}

      {{- $sectionLenTotal := sub $sectionLen 3 -}}

      {{- range $index, $page := $section -}}
        {{- if and (not .Params.ignoreSearch) (ne $page.Type "json") -}}
          {
            "version": "{{$page.Section | humanize}}",
            "url": "{{ $page.Permalink }}",
            "title": "{{ with $page.Params.bannertext }}{{htmlEscape .}}{{else}}{{htmlEscape $page.Title}}{{end}}",
            "description": "{{ htmlEscape .Description}}",
            "searchKeyword": "{{ htmlEscape .Params.searchKeyword}}",
            "content": {{$page.Plain | jsonify}},
            "_293yh2": "we"
          }{{- if eq $item $len -}}{{- if ne $index $sectionLenTotal -}},{{- end -}}{{- else -}},{{- end -}}
      {{- end -}}
    {{- end -}}

    {{- end -}}
  {{- end -}}
{{- end -}}]