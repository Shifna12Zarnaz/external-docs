{{- $version:= where site.Pages "Params.version" "!=" nil -}}
{{- $versionLength := sub (len $version) 1 -}}
{{- $secVerName := "" -}}
[
{{- range $i, $e := $version -}}
{{- $secVerName := .Params.version -}}
{{- range (where site.Pages "Section" $secVerName)  -}}
{{- range $index, $page := .Pages -}}
{{- if and (ne .Params.type "page") (not .IsPage) (ne $page.Type "json") -}}
  {
    "version": "{{ $secVerName }}",
    "url": "{{ $page.Permalink }}",
    "title": "{{ htmlEscape $page.Title}}",
    "description": "{{ htmlEscape .Description}}",
    "content": "{{ trim ($page.Plain | jsonify) `\n` }}"
  },
{{- end -}}
{{- end -}}
{{- end -}}
{{- if eq $i $versionLength -}}{}{{- end -}}
{{- end -}}
]